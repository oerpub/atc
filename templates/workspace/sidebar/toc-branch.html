<div class="editor-node-body editor-drop-zone editor-drop-zone-in">
{{! Renders a single node in the book editor tree}}
{{! Includes drop zones and supports nodes that point to content (with ids) and containers (chapter/unit)}}
{{! The div above MUST be here and MUST NOT have any spaces before it because the 'li' parent will render differently}}

{{#if isGroup}}
  <span class="editor-expand-collapse" title="Click to expand/collapse"><i class="icon-content"></i></span>
{{/if}}

<div class="btn-group pull-right">
  <button class="btn btn-mini pull-right edit-settings dropdown-toggle"
          data-toggle="dropdown"
          title="Edit/rename this {{prettyName}}"><i class="icon-pencil"></i></button>
  <ul class="dropdown-menu">
    <li>
      <button type="button" class="btn btn-link edit-settings-rename"
              data-placement="bottom" data-toggle="tooltip"i
              title="Rename this {{prettyName}}">Rename this {{prettyName}}</button>
    </li>
    <li>
      <button type="button" class="btn btn-link edit-settings-edit"
              data-placement="bottom" data-toggle="tooltip"i
              title="Leave the {{prettyName}} you are currently on and go edit this one">Go edit this {{prettyName}}</button>
    </li>
  </ul>
</div>
{{#if editAction}}
  <span data-media-type="{{#if content}}{{content.mediaType}}{{else}}{{mediaType}}{{/if}}" data-content-id="{{id}}" data-content-title="{{content.title}}" class="edit-action"><i class="icon-content"></i>
    {{! A book title (if set) overrides the module title}}
    {{#if title}}
      <span class="editor-node-title">{{title}}</span>
    {{else}}
      {{#if content}}
        <span class="editor-node-title autogenerated-text">{{content.title}}</span>
      {{else}}
        <span class="editor-node-title autogenerated-text">BUG:NO_TITLE_SET</span>
      {{/if}}
    {{/if}}


    {{#if _isDirty}}
      <small class="toc-badge">
        <span class="is-dirty" title="This has unsaved changes">
          <i class="icon-asterisk"></i>
        </span>
      </small>
    {{/if}}
    {{#if _hasRemoteChanges}}
      <small class="toc-badge">
        <span class="has-remote-changes" title="This has been changed by someone else">
          <i class="icon-refresh"></i>
        </span>
      </small>
    {{/if}}


  </span>
{{else}}
  <span class="go-edit" data-media-type="{{mediaType}}" data-content-title="{{title}}" class="no-edit-action editor-drop-zone editor-drop-zone-in"><i class="icon-content"></i>
    <span class="editor-node-title">
      <span {{#unless isGroup}}{{#unless selected}}class="btn-link"{{/unless}}{{/unless}}>
        <!-- If the content does not have a title (like an image) or it has not been looked up yet use the path -->
        {{#if title}}
          {{{title}}}
        {{else}}
          {{id}}
        {{/if}}
      </span>

      {{#if _isDirty}}
        <small class="toc-badge">
          <span class="is-dirty" title="This has unsaved changes">
            <i class="icon-asterisk"></i>
          </span>
        </small>
      {{/if}}
      {{#if _hasRemoteChanges}}
        <small class="toc-badge">
          <span class="has-remote-changes" title="This has been changed by someone else">
            <i class="icon-refresh"></i>
          </span>
        </small>
      {{/if}}
    </span>
  </span>
{{/if}}

</div>

{{#if hasParent}}
  {{#if hasChildren}}
  {{else}}
    <div class="editor-drop-zone editor-drop-zone-after editor-node-after"></div>
  {{/if}}
{{else}}
  <div class="editor-node-after"></div>
{{/if}}

{{! Always include the list because a node _may_ get children later}}
<ol></ol>

{{#if hasParent}}
  {{#if hasChildren}}
    <div class="editor-drop-zone editor-drop-zone-after editor-node-after"></div>
  {{/if}}
{{/if}}
